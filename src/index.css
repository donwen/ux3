/* Import Noto Sans TC (思源黑體) */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap');
/* Import M PLUS Rounded 1c for kawaii style */
@import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@300;400;500;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --transition-duration: 200ms;
    --transition-timing: cubic-bezier(0.4, 0, 0.2, 1);
    --kawaii-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply antialiased font-kawaii bg-pink-50 dark:bg-gray-900;
    background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffb6c1' fill-opacity='0.1' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='3'/%3E%3Ccircle cx='13' cy='13' r='3'/%3E%3C/g%3E%3C/svg%3E");
  }

  /* Typography */
  h1, h2, h3, h4, h5, h6 {
    @apply font-kawaii font-bold text-primary-800 dark:text-white;
  }

  h1 { @apply text-2xl; }
  h2 { @apply text-xl; }
  h3 { @apply text-lg; }

  /* Smooth theme transitions */
  * {
    transition: background-color var(--transition-duration) var(--transition-timing),
                border-color var(--transition-duration) var(--transition-timing),
                color var(--transition-duration) var(--transition-timing),
                transform var(--transition-duration) var(--transition-timing),
                box-shadow var(--transition-duration) var(--transition-timing),
                opacity var(--transition-duration) var(--transition-timing);
  }
}

@layer components {
  /* Kawaii Button styles with bounce hover effects */
  .btn {
    @apply px-4 py-2 rounded-kawaii font-medium transition-all duration-200
           transform hover:scale-[1.03] active:translate-y-1 active:scale-95;
  }

  .btn-primary {
    @apply bg-primary-500 text-white hover:bg-primary-400 shadow-kawaii 
           hover:shadow-kawaii-hover dark:bg-primary-600 dark:hover:bg-primary-500;
  }

  .btn-secondary {
    @apply bg-kawaii-peach text-primary-800 hover:bg-kawaii-peach/90 shadow-kawaii
           hover:shadow-kawaii-hover dark:bg-kawaii-lavender/90 dark:text-primary-900;
  }

  /* Kawaii Input styles with focus animations */
  .input {
    @apply w-full px-4 py-3 rounded-kawaii border-2 border-kawaii-pink/30 
           bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-gray-100
           focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-300
           placeholder-gray-400 dark:placeholder-gray-500 shadow-sm
           transition-all duration-200;
  }

  .input:focus {
    @apply animate-border-glow;
  }

  /* Kawaii Card styles with hover animations */
  .card {
    @apply bg-white/90 dark:bg-gray-800/90 rounded-none
           border border-kawaii-pink/10 dark:border-primary-700/20 overflow-hidden
           transition-all duration-300 hover:shadow-kawaii-hover
           transform hover:-translate-y-1 hover:scale-[1.01];
  }

  /* Kawaii menu item hover effect */
  .menu-item {
    @apply relative py-2 px-4 font-kawaii text-primary-700 dark:text-primary-300
           hover:text-primary-500 dark:hover:text-primary-400
           transition-colors duration-200;
  }

  .menu-item::after {
    content: '';
    @apply absolute bottom-0 left-1/2 h-1 w-0 bg-primary-400 rounded-full
           -translate-x-1/2 transform scale-x-0 transition-all duration-200;
  }

  .menu-item:hover::after {
    @apply w-2/3 scale-x-100;
  }

  /* Kawaii Scroll to top button */
  .scroll-top {
    @apply fixed bottom-6 right-6 p-3 rounded-full bg-primary-500 text-white
           shadow-kawaii hover:shadow-kawaii-hover hover:bg-primary-400
           transform hover:scale-110 hover:-translate-y-1 active:translate-y-1 active:scale-95
           transition-all duration-200 ease-out
           opacity-0 pointer-events-none;
  }

  .scroll-top.visible {
    @apply opacity-100 pointer-events-auto animate-fade-in;
  }

  /* Kawaii Loading skeleton animation */
  .skeleton {
    @apply bg-gradient-to-r from-pink-100 via-pink-200 to-pink-100 dark:from-gray-700 
           dark:via-gray-600 dark:to-gray-700 bg-[length:200%_100%] animate-shimmer
           rounded-kawaii;
  }
  
  /* Kawaii badge */
  .kawaii-badge {
    @apply inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium 
           bg-kawaii-pink/20 text-primary-700 dark:bg-kawaii-pink/30 dark:text-white
           border border-kawaii-pink/30 transition-all duration-200
           hover:scale-110 hover:shadow-sm;
  }
  
  /* Kawaii icon button */
  .kawaii-icon-btn {
    @apply p-1.5 rounded-full transition-all duration-200 bg-white/60 dark:bg-gray-800/60
           border border-kawaii-pink/20 dark:border-primary-700/30
           hover:bg-kawaii-pink/20 dark:hover:bg-primary-700/30
           hover:scale-110 active:scale-90;
  }
  
  /* Kawaii tooltip */
  .kawaii-tooltip {
    @apply relative inline-block;
  }
  
  .kawaii-tooltip::before {
    @apply content-[attr(data-tooltip)] absolute -top-10 left-1/2 -translate-x-1/2
           bg-kawaii-pink text-white px-3 py-1 rounded-kawaii text-sm whitespace-nowrap
           opacity-0 invisible transition-all duration-200 scale-90 z-10;
  }
  
  .kawaii-tooltip::after {
    @apply content-[''] absolute -top-3 left-1/2 -translate-x-1/2 border-4
           border-t-kawaii-pink border-x-transparent border-b-transparent
           opacity-0 invisible transition-all duration-200 z-10;
  }
  
  .kawaii-tooltip:hover::before,
  .kawaii-tooltip:hover::after {
    @apply opacity-100 visible scale-100;
  }

  /* 自定義樣式以保持方角 */
  .rounded-none {
    border-radius: 0 !important;
  }

  /* 為確保所有元素都是方角，覆蓋常見的圓角類 */
  .rounded, .rounded-sm, .rounded-md, .rounded-lg, .rounded-xl, .rounded-2xl, .rounded-full, .rounded-t, .rounded-b, .rounded-r, .rounded-l, .rounded-tr, .rounded-tl, .rounded-br, .rounded-bl {
    border-radius: 0 !important;
  }

  /* 視頻進度條樣式 */
  .video-progress-bar {
    @apply h-2.5 w-full bg-gray-600/50 rounded-none mb-2 cursor-pointer relative;
    transition: height 0.2s ease;
  }
  
  .video-progress-bar:hover {
    @apply h-3;
  }
  
  .video-progress-bar .progress-fill {
    @apply absolute top-0 left-0 h-full bg-primary-500 rounded-none;
  }
  
  .video-progress-bar .progress-handle {
    @apply absolute top-1/2 transform -translate-y-1/2 w-3 h-3 bg-white rounded-none shadow-lg opacity-0;
    transition: opacity 0.2s ease, width 0.2s ease, height 0.2s ease;
  }
  
  .video-progress-bar:hover .progress-handle,
  .video-progress-bar .progress-handle.active {
    @apply opacity-100 w-4 h-4;
  }
}

/* Kawaii parallax background effect */
.parallax-bg {
  @apply fixed inset-0 z-[-1] bg-gradient-to-br from-kawaii-pink/10 to-kawaii-sky/10
         dark:from-primary-900/50 dark:to-accent-900/40;
  transform: translateZ(0);
  will-change: transform;
}

/* Kawaii scrollbar */
::-webkit-scrollbar {
  @apply w-3;
}

::-webkit-scrollbar-track {
  @apply bg-kawaii-pink/10 dark:bg-gray-800 rounded-full;
}

::-webkit-scrollbar-thumb {
  @apply bg-primary-300 dark:bg-primary-700 rounded-full
         hover:bg-primary-400 dark:hover:bg-primary-600
         transition-colors duration-200 border-2 border-white/50 dark:border-gray-800/50;
}

/* Kawaii decoration elements */
.kawaii-dot-pattern {
  background-image: radial-gradient(circle, rgba(255, 94, 151, 0.1) 1px, transparent 1px);
  background-size: 20px 20px;
}

.kawaii-star {
  @apply inline-block text-kawaii-yellow animate-pulse-subtle;
}

.kawaii-cherry-blossom {
  @apply inline-block text-pink-400 animate-bounce-small;
}

/* 保留 .kawaii-heart 以兼容現有代碼，但樣式改為櫻花樣式 */
.kawaii-heart {
  @apply inline-block text-pink-400 animate-bounce-small;
}

/* Kawaii selection */
::selection {
  @apply bg-primary-300 text-white;
}

/* Layout optimization classes */
.kawaii-container {
  @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4;
}

.kawaii-section {
  @apply my-8 p-6 bg-white/80 dark:bg-gray-800/80 rounded-kawaii shadow-kawaii;
}

.kawaii-grid {
  @apply grid gap-4 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5;
}

.kawaii-flex-center {
  @apply flex items-center justify-center;
}

.kawaii-flex-between {
  @apply flex items-center justify-between;
}

.kawaii-divider {
  @apply my-2 h-px bg-kawaii-pink/20 dark:bg-primary-700/20 rounded-full;
}

.kawaii-page-header {
  @apply mb-6 pb-3 border-b border-kawaii-pink/20 dark:border-primary-700/20;
}

.kawaii-sidebar {
  @apply w-64 p-4 bg-white/90 dark:bg-gray-800/90 rounded-kawaii shadow-kawaii 
         border border-kawaii-pink/20 dark:border-primary-700/30;
}

.kawaii-main-content {
  @apply flex-1 p-4;
}

/* 輔助工具 */
.line-clamp-1 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 1;
}

.line-clamp-2 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
}

.cherry-blossom-container {
  @apply pointer-events-none overflow-hidden;
}

.cherry-blossom-petal {
  @apply absolute animate-fall animate-sway;
  will-change: transform;
}